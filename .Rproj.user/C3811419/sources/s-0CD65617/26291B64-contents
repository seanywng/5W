---
title: "Exploratory Data Analysis of the Dataset Swiss"
author: "Sean Ng"
date: "`r format(Sys.Date(), format='%d %B, %Y')`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library (pander)
library (psych)
library (tidyverse)
date1888 <- 1888
data(swiss)
cor1 <- cor(swiss$Fertility, swiss$Examination)
cor2 <- cor(swiss$Education, swiss$Examination)
(lm_fertility4 <- lm(Fertility ~ 
                         Agriculture+Education+Catholic+Infant.Mortality,
                       data = swiss))
(lm_fertilityall <- lm(Fertility ~ 
                     Agriculture+Examination+Education+Catholic+Infant.Mortality,
                   data = swiss))
lm_fertility3 <- lm(Fertility ~ 
                       Education+Catholic+Infant.Mortality,
                     data = swiss)
swiss$Canton <- rownames(swiss)
```

## Description and Initial Analysis of the Dataset

The dataset Swiss Fertility and Socioeconomic Indicators is comprised of **`r nrow(swiss)`** observations, one for each of the French-speaking provinces in Switzerland in the year `r (date1888)`. There are a total of **`r ncol(swiss)`** variables, each of which is in percent, in the dataset; a summary of them can be found below:

```{r, echo = FALSE}
pander(summary(swiss[1:6]), style = "rmarkdown", split.tables = 120)
```

Fertility, the focus of the dataset, has a minimum value of **`r min(swiss$Fertility)`**, pertaining to the Canton **`r (Cantonmin <- swiss[45,7])`**, and a maximum value of  **`r max(swiss$Fertility)`**, pertaining to the Canton **`r (Cantonmax <- swiss[3,7])`**. A more detailed breakdown and examination of the relationships between the variables within the dataset may be observed below: 

```{r, echo=FALSE,fig.width=14, fig.height=10}
pairs.panels(swiss [1:6],
             smooth = TRUE,      # If TRUE, draws loess smooths
             scale = FALSE,      # If TRUE, scales the correlation text font
             density = TRUE,     # If TRUE, adds density plots and histograms
             ellipses = FALSE,    # If TRUE, draws ellipses
             method = "pearson", # Correlation method (also "spearman" or "kendall")
             pch = 8,           # pch symbol
             lm = FALSE,         # If TRUE, plots linear fit rather than the LOESS (smoothed) fit
             cor = TRUE,         # If TRUE, reports correlations
             jiggle = FALSE,     # If TRUE, data points are jittered
             factor = 2,         # Jittering factor
             hist.col = 4,       # Histograms color
             stars = TRUE,       # If TRUE, adds significance level with stars
             ci = FALSE)         # If TRUE, adds confidence intervals
```

We note that Fertility has significant correlations with the rest of the other variables, notably with *% draftees receiving highest mark on army examination* and *% education beyond primary school for draftees*. However, it should also be noted that a limitation of a dataset is that it contains no variables pertaining to the socioeconomic conditions of women, which would probably limit its utitlity in explaining the variance in the Fertility variable. 

Nevertheless, an attempt has been made to develop a linear regression model. The first attempt, shown below had an adjusted R-squared of **`r round(summary(lm_fertilityall)$adj.r.squared,4)`**. 

```{r, echo = FALSE}
summary(lm_fertilityall <- lm(Fertility ~ 
                         Agriculture+Examination+Education+Catholic+Infant.Mortality,
                       data = swiss))
```

The variable *% draftees receiving highest mark on army examination* or *Examination* was then removed as it was not significant to the model, leading to am adjusted R-squared of **`r round(summary(lm_fertility4)$adj.r.squared, 4)`**, which has little difference from the model with all variables. Removing the next least significant variable results in a comparitively large drop in adjusted R-squared: **`r round(summary(lm_fertility3)$adj.r.squared, 4)`**.

It is suspected that Examination, which had the highest correlation coefficient with Fertility and Education, **`r round((cor1),2)`** and **`r round((cor2),2)`** respectively, may be a confounding variable in this dataset and has been removed. Further analysis is necessary to determine its exact relationship between the other variables and to see if it can be confidently used in a linear model. 



