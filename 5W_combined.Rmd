---
title: "Report on Education 5W data -- Venezuela"
author: "Sean Ng"
date: "`r format(Sys.Date(), format='%d %B, %Y')`"
output:
  html_document:
    toc: yes
    number_sections: yes
    code_download: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE,
                      fig.width = 10)
library(tidyverse)
library(lubridate)
library(stringr)
library(pander)
library(scales)
library(forcats)
library(janitor)
library(readxl)
library(ggmap)
library(sf)
library(patchwork)
library(maptools)
library(ggforce)
library(ggthemes)
library(plotly)
library(kableExtra)
library(DT)
library(tinytex)
library(webshot)

# pander thousands separator
panderOptions("big.mark", ",")

# MAKE SURE YOU READ IN THE RIGHT FILE -- CHECK TIMESTAMP
act_ben <- read_csv("211108_0113_act_ben.csv") 
u_ben <- read_csv("211108_0113_u_ben.csv") 

# sum(act_ben$beneficiarios)
# sum(u_ben$beneficiarios)

# census reference datasets
cen_ref <- read_excel("census_data_20191122.xlsx", sheet = "data") %>% 
  clean_names() %>%
  select(estado, pcode1, municipio, pcode2, parroquia, pcode3, field_office,
         poblacion_total_2011, x_2019_poblacion_parroquial_total,
         ham_2019_ambitos_ge, ham_2019_xx_pobreza_env_por_parroquia, 
         ham_2019_xx_poblacion_pobre_por_parroquia,
         poblacion_infantil_menor_de_12_anos, poblacion_adolescentes_de_12_a_17_anos,
         poblacion_de_18_anos_y_mas, 
         poblacion_urbana_percent, area_km2, densidad_poblacional_ppl_km2,
         matricula_2017_educacion_inicial, matricula_2017_educacion_primaria, 
         matricula_2017_educacion_media)

# filtering out PROMOCION MENSAJES CLAVES PARA LA COMUNIDAD ESCOLAR
CA105 <- act_ben %>% filter(actividad_codigo == "CA1.05")

# creating datasets without CA1.05 and
# for act_ben, recoding UNICEF and mutating short activity descriptions
act_ben2 <- act_ben %>% 
  filter(!str_detect(.$ubicacion, "^RADIO")) %>% 
  mutate(organizacion_implementadora = 
           str_replace_all(organizacion_implementadora, 
                           "UNICEF - Fondo de las Naciones Unidas para la Infancia",
                           "UNICEF")) %>% 
  mutate(actividad_short = recode(actividad_codigo, 
                             CA1.01 = "1.01_reinsercion educativa",
                             CA1.02 = "1.02_nivelacion y capacitacion",
                             CA1.03 = "1.03_kits escolares",
                             CA1.04 = "1.04_alimentacion escolar",
                             CA1.05 = "1.05_promocion mensajes claves",
                             CA1.06 = "1.06_apoyo psicoeducativo",
                             CA1.07 = "1.07_actividades recreativas",
                             CA2.08 = "2.08_educacion a distancia",
                             CA2.09 = "2.09_formacion docentes",
                             CA2.10 = "2.10_becas docentes"))
                    
u_ben2 <- u_ben %>% filter(!str_detect(.$ubicacion, "^RADIO"))



```