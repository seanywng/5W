group_by(age_ben) %>%
summarise(enrolment2017 = sum(matricula2017)) %>%
left_join(age_u_ben, by = "age_ben") %>%
mutate(percent_reached = beneficiaries/enrolment2017 * 100) %>%
relocate(beneficiaries, .after = age_ben) %>%
rename(`Age group` = age_ben) %>%
slice(2,3,1)  # rearranging rows
# creating reference dfs for the text and plot below
cum_u_ben <- u_ben |>
arrange(month_reported) |>
group_by(month_reported) |>
summarise(sum_ben = sum(beneficiaries)) |>
mutate(cumulative = cumsum(sum_ben))
cum_act_ben <- act_ben |>
arrange(month_reported) |>
group_by(month_reported) |>
summarise(sum_ben = sum(beneficiaries)) |>
mutate(cumulative = cumsum(sum_ben))
u_ben %>%
arrange(month_reported) |>
group_by(month_reported) |>
summarise(sum_ben = sum(beneficiaries)) |>
mutate(cumulative = cumsum(sum_ben)) |>
ggplot(aes(x = month_reported, y = cumulative)) +
geom_line() +
geom_text(aes(label = scales::comma(cumulative)), vjust = -0.25, hjust = 1, size = 3) +
scale_x_date(date_labels = "%b-%Y", date_breaks = "1 month") +
scale_y_continuous(labels = scales::unit_format(unit = "K", scale = 1e-3, sep = ""),
breaks = seq(0,950000, by = 200000)) + # what is this breaks doing?
xlab("Month reported") + ylab("Beneficiaries (cumulative)")
u_ben %>%
arrange(month_reported) |>
group_by(month_reported) |>
summarise(sum_ben = sum(beneficiaries)) |>
mutate(cumulative = cumsum(sum_ben)) |>
ggplot(aes(x = month_reported, y = cumulative)) +
geom_line()
u_ben %>%
mutate(month_reported = as.Date(month_reported)) |>
arrange(month_reported) |>
group_by(month_reported) |>
summarise(sum_ben = sum(beneficiaries)) |>
mutate(cumulative = cumsum(sum_ben)) |>
ggplot(aes(x = month_reported, y = cumulative)) +
geom_line() +
geom_text(aes(label = scales::comma(cumulative)), vjust = -0.25, hjust = 1, size = 3) +
scale_x_date(date_labels = "%b-%Y", date_breaks = "1 month") +
scale_y_continuous(labels = scales::unit_format(unit = "K", scale = 1e-3, sep = ""),
breaks = seq(0,950000, by = 200000)) + # what is this breaks doing?
xlab("Month reported") + ylab("Beneficiaries (cumulative)")
u_ben %>%
mutate(month_reported = as.Date(month_reported)) |>
arrange(month_reported) |>
group_by(month_reported) |>
summarise(sum_ben = sum(beneficiaries)) |>
mutate(cumulative = cumsum(sum_ben)) |>
ggplot(aes(x = month_reported, y = cumulative)) +
geom_line() +
geom_text(aes(label = scales::comma(cumulative)), vjust = -0.25, hjust = 1, size = 3) +
scale_x_date(date_labels = "%b-%y", date_breaks = "1 month") +
scale_y_continuous(labels = scales::unit_format(unit = "K", scale = 1e-3, sep = ""),
breaks = seq(0,950000, by = 200000)) + # what is this breaks doing?
xlab("Month reported") + ylab("Beneficiaries (cumulative)")
u_ben %>%
mutate(month_reported = as.Date(month_reported)) |>
arrange(month_reported) |>
group_by(month_reported) |>
summarise(sum_ben = sum(beneficiaries)) |>
mutate(cumulative = cumsum(sum_ben)) |>
ggplot(aes(x = month_reported, y = cumulative)) +
geom_line() +
geom_text(aes(label = scales::comma(cumulative)), vjust = -0.25, hjust = 1, size = 3) +
scale_x_date(date_labels = "%b", date_breaks = "1 month") +
scale_y_continuous(labels = scales::unit_format(unit = "K", scale = 1e-3, sep = ""),
breaks = seq(0,950000, by = 200000)) + # what is this breaks doing?
labs(x = "Month reported", y = "Beneficiaries (cumulative)",
title = "Beneficiaries reached in 2020")
cum_u_ben |> glimpse()
cum_u_ben$cumulative[11,3] - cum_u_ben$cumulative[9,3]
cum_u_ben$cumulative[11,3]
cum_u_ben |> glimpse()
cum_u_ben$cumulative[10,3]
cum_u_ben[11,3] - cum_u_ben[9,3]
(cum_u_ben[11,3] - cum_u_ben[9,3]) / cum_u_ben[11,3]
round((cum_u_ben[11,3] - cum_u_ben[9,3]) / cum_u_ben[11,3] * 100, digits = 2)
act_lines <- act_ben %>%
mutate(month_reported = as.Date(month_reported)) |>
group_by(activity_short, month_reported) |>
summarise(sum_ben = sum(benenficiaries)) |>
mutate(cumulative = round(cumsum(sum_ben))) |>
ggplot(aes(x = month_reported, y = cumulative, colour = activity_short)) +
geom_line() +
geom_point(size = .7) +
scale_x_date(date_labels = "%b", date_breaks = "1 month") +
scale_y_continuous(labels = unit_format(unit = "K",
scale = 1e-3,
sep = ""),
limits = c(0, 500000)) +
labs(x = "", y = "Beneficiaries",
title = "Progress by activity") +
scale_colour_discrete(name = "Activity") +
theme(legend.position = "bottom",
legend.text = element_text(size = 6)) +
guides(fill = guide_legend(nrow = 2, byrow = TRUE))
act_lines <- act_ben %>%
mutate(month_reported = as.Date(month_reported)) |>
group_by(activity_short, month_reported) |>
summarise(sum_ben = sum(beneficiaries)) |>
mutate(cumulative = round(cumsum(sum_ben))) |>
ggplot(aes(x = month_reported, y = cumulative, colour = activity_short)) +
geom_line() +
geom_point(size = .7) +
scale_x_date(date_labels = "%b", date_breaks = "1 month") +
scale_y_continuous(labels = unit_format(unit = "K",
scale = 1e-3,
sep = ""),
limits = c(0, 500000)) +
labs(x = "", y = "Beneficiaries",
title = "Progress by activity") +
scale_colour_discrete(name = "Activity") +
theme(legend.position = "bottom",
legend.text = element_text(size = 6)) +
guides(fill = guide_legend(nrow = 2, byrow = TRUE))
ggplotly(act_lines, tooltip = c("x", "y", "colour")) %>%
layout(showlegend = TRUE, legend = list(font = list(size = 6))) %>%
config(displayModeBar = FALSE)
act_lines <- act_ben %>%
mutate(month_reported = as.Date(month_reported)) |>
group_by(activity_short, month_reported) |>
summarise(sum_ben = sum(beneficiaries)) |>
mutate(cumulative = round(cumsum(sum_ben)),
tooltip_text = paste0(
"activity: ", activity_short, "\n",
"month: ", month(month_reported), "\n",
"beneficiaries: ", format(sum_ben, big.mark = ","), "\n",
"cumulative :", format(cumulative, big.mark = ","))) |>
ggplot(aes(x = month_reported, y = cumulative, colour = activity_short,
text = tooltip_text)) +
geom_line() +
geom_point(size = .7) +
scale_x_date(date_labels = "%b", date_breaks = "1 month") +
scale_y_continuous(labels = unit_format(unit = "K",
scale = 1e-3,
sep = ""),
limits = c(0, 500000)) +
labs(x = "", y = "Beneficiaries",
title = "Progress by activity") +
scale_colour_discrete(name = "Activity") +
theme(legend.position = "bottom",
legend.text = element_text(size = 6)) +
guides(fill = guide_legend(nrow = 2, byrow = TRUE))
ggplotly(act_lines, tooltip = c("tooltip_text")) %>%
layout(showlegend = TRUE, legend = list(font = list(size = 6))) %>%
config(displayModeBar = FALSE)
act_lines <- act_ben %>%
mutate(month_reported = as.Date(month_reported)) |>
group_by(activity_short, month_reported) |>
summarise(sum_ben = sum(beneficiaries)) |>
mutate(cumulative = round(cumsum(sum_ben)),
tooltip_text = paste0(
"activity: ", activity_short, "\n",
"month: ", month(month_reported), "\n",
"beneficiaries: ", format(sum_ben, big.mark = ","), "\n",
"cumulative :", format(cumulative, big.mark = ","))) |>
ggplot(aes(x = month_reported, y = cumulative, colour = activity_short,
text = tooltip_text)) +
geom_line() +
geom_point(size = .7) +
scale_x_date(date_labels = "%b", date_breaks = "1 month") +
scale_y_continuous(labels = unit_format(unit = "K",
scale = 1e-3,
sep = ""),
limits = c(0, 500000)) +
labs(x = "", y = "Beneficiaries",
title = "Progress by activity") +
scale_colour_discrete(name = "Activity") +
theme(legend.position = "bottom",
legend.text = element_text(size = 6)) +
guides(fill = guide_legend(nrow = 2, byrow = TRUE))
ggplotly(act_lines, tooltip = c("tooltip_text")) %>%
layout(showlegend = TRUE, legend = list(font = list(size = 6))) %>%
config(displayModeBar = FALSE)
act_lines <- act_ben %>%
mutate(month_reported = as.Date(month_reported)) |>
group_by(activity_short, month_reported) |>
summarise(sum_ben = sum(beneficiaries)) |>
mutate(cumulative = round(cumsum(sum_ben)),
tooltip_text = paste0(
"activity: ", activity_short, "\n",
"month: ", month(month_reported), "\n",
"beneficiaries: ", format(sum_ben, big.mark = ","), "\n",
"cumulative :", format(cumulative, big.mark = ","))) |>
ggplot(aes(x = month_reported, y = cumulative, colour = activity_short,
labels = tooltip_text)) +
geom_line() +
geom_point(size = .7) +
scale_x_date(date_labels = "%b", date_breaks = "1 month") +
scale_y_continuous(labels = unit_format(unit = "K",
scale = 1e-3,
sep = ""),
limits = c(0, 500000)) +
labs(x = "", y = "Beneficiaries",
title = "Progress by activity") +
scale_colour_discrete(name = "Activity") +
theme(legend.position = "bottom",
legend.text = element_text(size = 6)) +
guides(fill = guide_legend(nrow = 2, byrow = TRUE))
act_lines <- act_ben %>%
mutate(month_reported = as.Date(month_reported)) |>
group_by(activity_short, month_reported) |>
summarise(sum_ben = sum(beneficiaries),
.groups = "drop") |>
mutate(cumulative = round(cumsum(sum_ben)),
tooltip_text = paste0(
"activity: ", activity_short, "\n",
"month: ", month(month_reported), "\n",
"beneficiaries: ", format(sum_ben, big.mark = ","), "\n",
"cumulative :", format(cumulative, big.mark = ","))) |>
ggplot(aes(x = month_reported, y = cumulative, colour = activity_short,
labels = tooltip_text)) +
geom_line() +
geom_point(size = .7) +
scale_x_date(date_labels = "%b", date_breaks = "1 month") +
scale_y_continuous(labels = unit_format(unit = "K",
scale = 1e-3,
sep = ""),
limits = c(0, 500000)) +
labs(x = "", y = "Beneficiaries",
title = "Progress by activity") +
scale_colour_discrete(name = "Activity") +
theme(legend.position = "bottom",
legend.text = element_text(size = 6)) +
guides(fill = guide_legend(nrow = 2, byrow = TRUE))
ggplotly(act_lines, tooltip = c("tooltip_text")) %>%
layout(showlegend = TRUE, legend = list(font = list(size = 6))) %>%
config(displayModeBar = FALSE)
act_lines <- act_ben %>%
mutate(month_reported = as.Date(month_reported)) |>
group_by(activity_short, month_reported) |>
summarise(sum_ben = sum(beneficiaries),
.groups = "drop") |>
mutate(cumulative = round(cumsum(sum_ben)),
tooltip_text = paste0(
"activity: ", activity_short, "\n",
"month: ", month(month_reported), "\n",
"beneficiaries: ", format(sum_ben, big.mark = ","), "\n",
"cumulative :", format(cumulative, big.mark = ","))) |>
ggplot(aes(x = month_reported, y = cumulative, colour = activity_short)) +
geom_line() +
geom_point(size = .7) +
scale_x_date(date_labels = "%b", date_breaks = "1 month") +
scale_y_continuous(labels = unit_format(unit = "K",
scale = 1e-3,
sep = ""),
limits = c(0, 500000)) +
labs(x = "", y = "Beneficiaries",
title = "Progress by activity") +
scale_colour_discrete(name = "Activity") +
theme(legend.position = "bottom",
legend.text = element_text(size = 6)) +
guides(fill = guide_legend(nrow = 2, byrow = TRUE))
ggplotly(act_lines, tooltip = c("tooltip_text")) %>%
layout(showlegend = TRUE, legend = list(font = list(size = 6))) %>%
config(displayModeBar = FALSE)
# Why is this not working?
act_lines <- act_ben %>%
mutate(month_reported = as.Date(month_reported)) |>
group_by(activity_short, month_reported) |>
summarise(sum_ben = sum(beneficiaries),
.groups = "drop") |>
mutate(cumulative = round(cumsum(sum_ben))) |>
ggplot(aes(x = month_reported, y = cumulative, colour = activity_short),
text = paste0(
"activity: ", activity_short, "\n",
"month: ", month(month_reported), "\n",
"beneficiaries: ", format(sum_ben, big.mark = ","), "\n",
"cumulative :", format(cumulative, big.mark = ","))) +
geom_line() +
geom_point(size = .7) +
scale_x_date(date_labels = "%b", date_breaks = "1 month") +
scale_y_continuous(labels = unit_format(unit = "K",
scale = 1e-3,
sep = ""),
limits = c(0, 500000)) +
labs(x = "", y = "Beneficiaries",
title = "Progress by activity") +
scale_colour_discrete(name = "Activity") +
theme(legend.position = "bottom",
legend.text = element_text(size = 6)) +
guides(fill = guide_legend(nrow = 2, byrow = TRUE))
ggplotly(act_lines, tooltip = c("text")) %>%
layout(showlegend = TRUE, legend = list(font = list(size = 6))) %>%
config(displayModeBar = FALSE)
# Why is this not working?
act_lines <- act_ben %>%
mutate(month_reported = as.Date(month_reported)) |>
group_by(activity_short, month_reported) |>
summarise(sum_ben = sum(beneficiaries),
.groups = "drop") |>
mutate(cumulative = round(cumsum(sum_ben))) |>
ggplot(aes(x = month_reported, y = cumulative, colour = activity_short)) +
geom_line() +
geom_point(size = .7) +
scale_x_date(date_labels = "%b", date_breaks = "1 month") +
scale_y_continuous(labels = unit_format(unit = "K",
scale = 1e-3,
sep = ""),
limits = c(0, 500000)) +
labs(x = "", y = "Beneficiaries",
title = "Progress by activity") +
scale_colour_discrete(name = "Activity") +
theme(legend.position = "bottom",
legend.text = element_text(size = 6)) +
guides(fill = guide_legend(nrow = 2, byrow = TRUE))
ggplotly(act_lines, tooltip = c("x", "y", "colour")) %>%
layout(showlegend = TRUE, legend = list(font = list(size = 6))) %>%
config(displayModeBar = FALSE)
# Why is this not working?
act_lines <- act_ben %>%
mutate(month_reported = as.Date(month_reported)) |>
group_by(activity_short, month_reported) |>
summarise(sum_ben = sum(beneficiaries)) |>
mutate(cumulative = round(cumsum(sum_ben))) |>
ggplot(aes(x = month_reported, y = cumulative, colour = activity_short)) +
geom_line() +
geom_point(size = .7) +
scale_x_date(date_labels = "%b", date_breaks = "1 month") +
scale_y_continuous(labels = unit_format(unit = "K",
scale = 1e-3,
sep = ""),
limits = c(0, 500000)) +
labs(x = "", y = "Beneficiaries",
title = "Progress by activity") +
scale_colour_discrete(name = "Activity") +
theme(legend.position = "bottom",
legend.text = element_text(size = 6)) +
guides(fill = guide_legend(nrow = 2, byrow = TRUE))
ggplotly(act_lines, tooltip = c("x", "y", "colour")) %>%
layout(showlegend = TRUE, legend = list(font = list(size = 6))) %>%
config(displayModeBar = FALSE)
# Why is this not working?
act_lines <- act_ben %>%
mutate(month_reported = as.Date(month_reported)) |>
group_by(activity_short, month_reported) |>
summarise(sum_ben = sum(beneficiaries)) |>
mutate(cumulative = round(cumsum(sum_ben))) |>
ggplot(aes(x = month_reported, y = cumulative, colour = activity_short),
text = paste0(
"activity: ", activity_short, "\n",
"month: ", month(month_reported), "\n",
"beneficiaries: ", format(sum_ben, big.mark = ","), "\n",
"cumulative :", format(cumulative, big.mark = ","))) +
geom_line() +
geom_point(size = .7) +
scale_x_date(date_labels = "%b", date_breaks = "1 month") +
scale_y_continuous(labels = unit_format(unit = "K",
scale = 1e-3,
sep = ""),
limits = c(0, 500000)) +
labs(x = "", y = "Beneficiaries",
title = "Progress by activity") +
scale_colour_discrete(name = "Activity") +
theme(legend.position = "bottom",
legend.text = element_text(size = 6)) +
guides(fill = guide_legend(nrow = 2, byrow = TRUE))
ggplotly(act_lines, tooltip = c("text")) %>%
layout(showlegend = TRUE, legend = list(font = list(size = 6))) %>%
config(displayModeBar = FALSE)
# Why is the custom tooltip not working?
act_lines <- act_ben %>%
mutate(month_reported = as.Date(month_reported)) |>
group_by(activity_short, month_reported) |>
summarise(sum_ben = sum(beneficiaries)) |>
mutate(cumulative = round(cumsum(sum_ben))) |>
ggplot(aes(x = month_reported, y = cumulative, colour = activity_short,
text = paste0(
"activity: ", activity_short, "\n",
"month: ", month(month_reported), "\n",
"beneficiaries: ", format(sum_ben, big.mark = ","), "\n",
"cumulative :", format(cumulative, big.mark = ",")))) +
geom_line() +
geom_point(size = .7) +
scale_x_date(date_labels = "%b", date_breaks = "1 month") +
scale_y_continuous(labels = unit_format(unit = "K",
scale = 1e-3,
sep = ""),
limits = c(0, 500000)) +
labs(x = "", y = "Beneficiaries",
title = "Progress by activity") +
scale_colour_discrete(name = "Activity") +
theme(legend.position = "bottom",
legend.text = element_text(size = 6)) +
guides(fill = guide_legend(nrow = 2, byrow = TRUE))
ggplotly(act_lines, tooltip = c("text")) %>%
layout(showlegend = TRUE, legend = list(font = list(size = 6))) %>%
config(displayModeBar = FALSE)
# Why is the custom tooltip not working?
act_lines <- act_ben %>%
mutate(month_reported = as.Date(month_reported)) |>
group_by(activity_short, month_reported) |>
summarise(sum_ben = sum(beneficiaries)) |>
mutate(cumulative = round(cumsum(sum_ben))) |>
ggplot(aes(x = month_reported, y = cumulative, colour = activity_short,
text = paste0(
"activity: ", activity_short, "\n",
"month: ", month(month_reported), "\n",
"beneficiaries: ", format(sum_ben, big.mark = ","), "\n",
"cumulative :", format(cumulative, big.mark = ",")),
group = activity_short)) +
geom_line() +
geom_point(size = .7) +
scale_x_date(date_labels = "%b", date_breaks = "1 month") +
scale_y_continuous(labels = unit_format(unit = "K",
scale = 1e-3,
sep = ""),
limits = c(0, 500000)) +
labs(x = "", y = "Beneficiaries",
title = "Progress by activity") +
scale_colour_discrete(name = "Activity") +
theme(legend.position = "bottom",
legend.text = element_text(size = 6)) +
guides(fill = guide_legend(nrow = 2, byrow = TRUE))
ggplotly(act_lines, tooltip = c("text")) %>%
layout(showlegend = TRUE, legend = list(font = list(size = 6))) %>%
config(displayModeBar = FALSE)
# Why is the custom tooltip not working?
act_lines <- act_ben %>%
mutate(month_reported = as.Date(month_reported)) |>
group_by(activity_short, month_reported) |>
summarise(sum_ben = sum(beneficiaries)) |>
mutate(cumulative = round(cumsum(sum_ben))) |>
ggplot(aes(x = month_reported, y = cumulative, colour = activity_short,
text = paste0(
"activity: ", activity_short, "\n",
"month: ", month(month_reported, label = TRUE), "\n",
"beneficiaries: ", format(sum_ben, big.mark = ","), "\n",
"cumulative :", format(cumulative, big.mark = ",")),
group = activity_short)) +
geom_line() +
geom_point(size = .7) +
scale_x_date(date_labels = "%b", date_breaks = "1 month") +
scale_y_continuous(labels = unit_format(unit = "K",
scale = 1e-3,
sep = ""),
limits = c(0, 500000)) +
labs(x = "", y = "Beneficiaries",
title = "Progress by activity") +
scale_colour_discrete(name = "Activity") +
theme(legend.position = "bottom",
legend.text = element_text(size = 6)) +
guides(fill = guide_legend(nrow = 2, byrow = TRUE))
ggplotly(act_lines, tooltip = c("text")) %>%
layout(showlegend = TRUE, legend = list(font = list(size = 6))) %>%
config(displayModeBar = FALSE)
# Why is the custom tooltip not working?
act_lines <- act_ben %>%
mutate(month_reported = as.Date(month_reported)) |>
group_by(activity_short, month_reported) |>
summarise(sum_ben = sum(beneficiaries)) |>
mutate(cumulative = round(cumsum(sum_ben))) |>
ggplot(aes(x = month_reported, y = cumulative, colour = activity_short,
text = paste0(
"activity: ", activity_short, "\n",
"month: ", month(month_reported, label = TRUE), "\n",
"beneficiaries: ", format(round(sum_ben), big.mark = ","), "\n",
"cumulative :", format(cumulative, big.mark = ",")),
group = activity_short)) +
geom_line() +
geom_point(size = .7) +
scale_x_date(date_labels = "%b", date_breaks = "1 month") +
scale_y_continuous(labels = unit_format(unit = "K",
scale = 1e-3,
sep = ""),
limits = c(0, 500000)) +
labs(x = "", y = "Beneficiaries",
title = "Progress by activity") +
scale_colour_discrete(name = "Activity") +
theme(legend.position = "bottom",
legend.text = element_text(size = 6)) +
guides(fill = guide_legend(nrow = 2, byrow = TRUE))
ggplotly(act_lines, tooltip = c("text")) %>%
layout(showlegend = TRUE, legend = list(font = list(size = 6))) %>%
config(displayModeBar = FALSE)
# Why is the custom tooltip not working?
act_lines <- act_ben %>%
mutate(month_reported = as.Date(month_reported)) |>
group_by(activity_short, month_reported) |>
summarise(sum_ben = sum(beneficiaries)) |>
mutate(cumulative = round(cumsum(sum_ben))) |>
ggplot(aes(x = month_reported, y = cumulative, colour = activity_short,
text = paste0(
"activity: ", activity_short, "\n",
"month: ", month(month_reported, label = TRUE), "\n",
"beneficiaries: ", format(round(sum_ben), big.mark = ","), "\n",
"cumulative: ", format(cumulative, big.mark = ",")),
group = activity_short)) +
geom_line() +
geom_point(size = .7) +
scale_x_date(date_labels = "%b", date_breaks = "1 month") +
scale_y_continuous(labels = unit_format(unit = "K",
scale = 1e-3,
sep = ""),
limits = c(0, 500000)) +
labs(x = "", y = "Beneficiaries",
title = "Progress by activity") +
scale_colour_discrete(name = "Activity") +
theme(legend.position = "bottom",
legend.text = element_text(size = 6)) +
guides(fill = guide_legend(nrow = 2, byrow = TRUE))
ggplotly(act_lines, tooltip = c("text")) %>%
layout(showlegend = TRUE, legend = list(font = list(size = 6))) %>%
config(displayModeBar = FALSE)
